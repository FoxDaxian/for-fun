{"version":3,"file":"bundle.js","sources":["../utils/raf.js","../src/index.js"],"sourcesContent":["const t = (function() {\n    var lastTime = 0;\n    var vendors = ['ms', 'moz', 'webkit', 'o'];\n    for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n        window.requestAnimationFrame =\n            window[vendors[x] + 'RequestAnimationFrame'];\n        window.cancelAnimationFrame =\n            window[vendors[x] + 'CancelAnimationFrame'] ||\n            window[vendors[x] + 'CancelRequestAnimationFrame'];\n    }\n\n    if (!window.requestAnimationFrame)\n        window.requestAnimationFrame = function(callback, element) {\n            var currTime = new Date().getTime();\n            var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n            var id = window.setTimeout(function() {\n                callback(currTime + timeToCall);\n            }, timeToCall);\n            lastTime = currTime + timeToCall;\n            return id;\n        };\n\n    if (!window.cancelAnimationFrame)\n        window.cancelAnimationFrame = function(id) {\n            clearTimeout(id);\n        };\n    const raf = window.requestAnimationFrame;\n    const clraf = window.cancelAnimationFrame;\n    return {\n        raf,\n        clraf\n    };\n})();\nexport default t\n","import r from '../utils/raf';\nconst { raf, clraf } = r;\n\nclass ani {\n    constructor(el) {\n        this.el = typeof el == 'string' ? document.querySelector(el) : el;\n        this.style = this.el.style;\n    }\n\n    setMode(k, end) {\n        let v;\n        // transform dir\n        let td = null;\n        switch (true) {\n            case /(left|translateX)/.test(k):\n                k = 'transform';\n                v = 'translateX';\n                td = 1;\n                break;\n            case /right/.test(k):\n                k = 'transform';\n                v = 'translateX';\n                td = -1;\n                break;\n            case /(top|translateY)/.test(k):\n                k = 'transform';\n                v = 'translateY';\n                td = 1;\n                break;\n            case /bottom/.test(k):\n                k = 'transform';\n                v = 'translateY';\n                td = -1;\n                break;\n            case /(height|width)/.test(k):\n                v = k;\n                end = end < 0 ? 0 : end;\n                break;\n            case /rotate/.test(k):\n                v = k;\n                k = 'transform';\n                break;\n            case /scale/.test(k):\n                console.log('正则');\n                v = k;\n                k = 'transform';\n                break;\n            default:\n                break;\n        }\n        this.k = k;\n        this.v = v;\n        this.td = td;\n        return end;\n    }\n\n    // 获取只读\n    getStyle() {\n        return (\n            this.el.style[this.k] ||\n            (this.el.currentStyle\n                ? this.el.currentStyle[this.k]\n                : window.getComputedStyle(this.el, false)[this.k])\n        );\n    }\n\n    // 设置css\n    setStyle(v) {\n        switch (true) {\n            case /(translateX|translateY)/.test(this.v):\n                v = v * this.td;\n                v = `${this.v}(${v * this.td}px)`;\n                break;\n            case /rotate/.test(this.v):\n                v = `${this.v}(${v}deg)`;\n                break;\n            case /height|width/.test(this.v):\n                v = `${v}px`;\n                break;\n            case /scale|scaleX|scaleY/.test(this.v):\n                v = `${this.v}(${v})`;\n                break;\n            default:\n                break;\n        }\n        return (this.style[this.k] = v);\n    }\n\n    // 获取number\n    getNumber(value) {\n        const patt = new RegExp('-?[\\\\d\\\\.]', 'g');\n        const res =\n            typeof value === 'number'\n                ? String(value).match(patt)\n                : value.match(patt);\n        return res !== null ? +res.join('') : 0;\n    }\n\n    // launch\n    ani(attr, end) {\n        end = this.getNumber(end);\n        end = this.setMode(attr, end);\n\t\t// 转化和缓存\n        console.log(this.k);\n        console.log(this.v);\n        const style = this.getStyle(this.k);\n\t\tconsole.log(style);\n\t\tif (this.k === 'transform') {\n            const matrix = style.match(/\\(.+\\)/g)[0].slice(1, -1).split(',')\n            \n        // https://fanmingfei.com/posts/CSS3_Transform_Matrix_Intro.html 这个很全面\n\t\t// http://www.cnblogs.com/shibaxiong/p/4673035.html 这个网站获取角度\n\t\t// 张鑫旭 http://www.zhangxinxu.com/wordpress/2012/06/css3-transform-matrix-%E7%9F%A9%E9%98%B5/\n            // 根据公式来算\n            // transform: matrix(1, 0, 0, 1, 30, 30); /* a=1, b=0, c=0, d=1, e=30, f=30 */\n            // 其中，x, y表示转换元素的  !!所有!!  坐标（变量）\n            // translateX: ax + cy + e\n            // translateY: bx + dy + f\n            // scaleX: sx\n            // scaleY: sy\n            // rotateX: x * cosθ - y * sinθ\n            // rotateY: x * sinθ + y * cosθ\n\t\t\t// skewX: tan(c)\n\t\t\t// skewY: tan(b)\n\t\t}\n        const start = this.getNumber(style);\n        this.td !== null && (end *= this.td);\n        // 增加还是减少\n        this.inOrde = end - start > 0 ? 1 : -1;\n        if (/(auto|none)/.test(this.getStyle(this.k))) {\n            this.setStyle(0);\n        }\n        this.innerAni(this.k, start, end);\n    }\n\n    // 动画速度轨迹\n    innerAni(attr, start, end) {\n        let i = start;\n        const fn = () => {\n            i += 0.01 * this.inOrde;\n            this.setStyle(i);\n\n            // if (this.inOrde > 0) {\n            //     if (this.getNumber(this.getStyle(this.k)) < end) {\n            //         raf(fn);\n            //     }\n            // } else {\n            //     if (this.getNumber(this.getStyle(this.k)) > end) {\n            //         raf(fn);\n            //     }\n            // }\n        };\n        raf(fn);\n    }\n\n    fn() {}\n}\n\nconst o = new ani('.box');\no.ani('left', '2');\n"],"names":["t","lastTime","vendors","x","length","window","requestAnimationFrame","cancelAnimationFrame","callback","element","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","raf","clraf","r","ani","el","document","querySelector","style","k","end","v","td","test","log","currentStyle","getComputedStyle","value","patt","RegExp","res","String","match","join","attr","getNumber","setMode","getStyle","matrix","slice","split","start","inOrde","setStyle","innerAni","i","fn","o"],"mappings":"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"}